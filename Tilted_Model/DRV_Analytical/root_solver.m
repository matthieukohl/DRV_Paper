function F = root_solver(r,L,x)

% x(1) = sigma, x(2) = b, x(3) = c1, x(4) = c2, x(5) = a

k1 = 1/sqrt(2*r)*sqrt(1-r*(2+x(1)^2)+sqrt(1+r^2*(x(1)^4+4*x(1)^2)-6*r*x(1)^2));

k2 = 1/sqrt(2*r)*sqrt(1-r*(2+x(1)^2)-sqrt(1+r^2*(x(1)^4+4*x(1)^2)-6*r*x(1)^2));


F(1) = x(5)/(r+x(1)^2-1)+x(3)*cos(k1*x(2))+x(4)*cos(k2*x(2));

F(2) = -r*x(3)*k1*sin(k1*x(2))-r*x(4)*k2*sin(k2*x(2))-x(5)/x(1)^2-(1-x(1));

F(3) = x(5)*x(2)/(r+x(1)^2-1)+x(3)/k1*sin(k1*x(2))+x(4)/k2*sin(k2*x(2))+...
    x(5)/x(1)^2*(L-x(2))+x(5)/x(1)^2*(exp(-(L-x(2)))-1)+...
    -1/x(1)*(exp(-x(1)*(L-x(2)))-1)+(exp(-(L-x(2)))-1);

F(4) = -r*x(3)*k1^2*cos(k1*x(2))-r*x(4)*k2^2*cos(k2*x(2))+x(5)/x(1)^2-(x(1)^2-1);

%F(5) = (r-1)*(x(5)*x(2)/(x(1)^2+r-1)+x(3)/k1*sin(k1*x(2))+x(4)/k2*sin(k2*x(2)))-x(5)*L;

F(5) = x(5)*x(2)*r/(r+x(1)^2-1)+r*x(3)/k1*sin(k1*x(2))+r*x(4)/k2*sin(k2*x(2))+...
   x(5)/x(1)^2*(L-x(2))+x(5)/x(1)^2*(exp(-(L-x(2)))-1)+...
   -1/x(1)*(exp(-x(1)*(L-x(2)))-1)+(exp(-(L-x(2)))-1)-x(5)*L;

%  F(1) = x(5)/(r+x(1)^2-1)+x(3)*cos(k1*x(2))+x(4)*cos(k2*x(2));
% 
% F(2) = -r*x(3)*k1*sin(k1*x(2))-r*x(4)*k2*sin(k2*x(2))-x(5)/x(1)^2-(1-x(1));
% 
% F(3) = x(5)*x(2)/(r+x(1)^2-1)+x(3)/k1*sin(k1*x(2))+x(4)/k2*sin(k2*x(2))+...
%     x(5)/x(1)^2*(L-x(2))+x(5)/x(1)^2*(exp(-(L-x(2)))-1)+...
%     -1/x(1)*(exp(-(L-x(2)))-1)+(exp(-(L-x(2)))-1);
% 
% F(4) = -r*x(3)*k1^2*cos(k1*x(2))-r*x(4)*k2^2*cos(k2*x(2))+x(5)/x(1)^2-(x(1)^2-1);
% 
% F(5) = (r-1)*(x(5)*x(2)/(x(1)^2+r-1)+x(3)/k1*sin(k1*x(2))+x(4)/k2*sin(k2*x(2)))-x(5)*L;
% 




% if x(1)>=1
%  F(1) = x(5)/(r+x(1)^2-1)+x(3)*cos(k1*x(2))+x(4)*cos(k2*x(2));
% 
% F(2) = -r*x(3)*k1*sin(k1*x(2))-r*x(4)*k2*sin(k2*x(2))-x(5)/x(1)^2-(1-x(1));
% 
% F(3) = x(5)*x(2)/(r+x(1)^2-1)+x(3)/k1*sin(k1*x(2))+x(4)/k2*sin(k2*x(2))+...
%     x(5)/x(1)^2*(L-x(2))+x(5)/x(1)^2*(exp(-(L-x(2)))-1)+...
%     -1/x(1)*(exp(-(L-x(2)))-1)+(exp(-(L-x(2)))-1);
% 
% F(4) = -r*x(3)*k1^2*cos(k1*x(2))-r*x(4)*k2^2*cos(k2*x(2))+x(5)/x(1)^2-(x(1)^2-1);
% 
% F(5) = (r-1)*(x(5)*x(2)/(x(1)^2+r-1)+x(3)/k1*sin(k1*x(2))+x(4)/k2*sin(k2*x(2)))-x(5)*L;
% 
% else
%    
% F(1) = x(5)/(r+x(1)^2-1)+x(3)*cos(k1*x(2))+x(4)*cos(k2*x(2));
% 
% F(2) = -r*x(3)*k1*sin(k1*x(2))-r*x(4)*k2*sin(k2*x(2))-x(5)/x(1)^2+(1-x(1));
% 
% F(3) = x(5)*x(2)/(r+x(1)^2-1)+x(3)/k1*sin(k1*x(2))+x(4)/k2*sin(k2*x(2))+...
%     x(5)/x(1)^2*(L-x(2))+x(5)/x(1)^2*(exp(-(L-x(2)))-1)+...
%     +1/x(1)*(exp(-(L-x(2)))-1)-(exp(-(L-x(2)))-1);
% 
% F(4) = -r*x(3)*k1^2*cos(k1*x(2))-r*x(4)*k2^2*cos(k2*x(2))+x(5)/x(1)^2+(x(1)^2-1);
% 
% F(5) = (r-1)*(x(5)*x(2)/(x(1)^2+r-1)+x(3)/k1*sin(k1*x(2))+x(4)/k2*sin(k2*x(2)))-x(5)*L;
% 
% end
    
end